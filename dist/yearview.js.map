{"version":3,"file":"yearview.js","sources":["../src/yearview.js"],"sourcesContent":["export default {\n  // date range\n  dateAlignment: \"year\",\n  duration: { years: 1 },\n\n  // content\n  content: (args) => {\n    const today = new Date();\n    const options = calendar.getCurrentData().options;\n    const end = args.dateProfile.renderRange.end;\n    const evtInstances = Object.values(args.eventStore.instances);\n    const table = document.createElement(\"table\");\n    table.classList.add(\"fc-scrollgrid\");\n\n    // find events\n    const events = [];\n    for (let i = 0; i < evtInstances.length; i++) {\n      const src = args.eventUiBases[evtInstances[i].defId];\n      events.push({\n        instance: evtInstances[i],\n        def: args.eventStore.defs[evtInstances[i].defId],\n        src: src,\n      });\n    }\n\n    // loop days\n    for (let date = -1; date <= 37; date++) {\n      let row;\n      if (date == -1)\n        row = table.appendChild(document.createElement(\"colgroup\"));\n      else row = table.appendChild(document.createElement(\"tr\"));\n      const month = new Date(args.dateProfile.renderRange.start.valueOf());\n      month.setDate(1);\n      while (month.getTime() < end.getTime()) {\n        // offset of month\n        const offset = (month.getDay() + 6) % 7;\n        const real = new Date(month.valueOf());\n        real.setDate(date - offset);\n\n        // colgroups\n        if (date == -1) {\n          row.appendChild(document.createElement(\"col\")).style.width = \"30px\";\n          row.appendChild(document.createElement(\"col\")).style.minWidth =\n            \"50px\";\n        }\n\n        // month header\n        else if (date == 0) {\n          const cell = row.appendChild(document.createElement(\"th\"));\n          cell.colSpan = 2;\n          const link = cell\n            .appendChild(document.createElement(\"div\"))\n            .appendChild(document.createElement(\"a\"));\n          link.classList.add(\"fc-col-header-cell-cushion\");\n          link.appendChild(\n            document.createTextNode(\n              month.toLocaleString(\"de\", { month: \"long\" })\n            )\n          );\n        }\n\n        // month offset\n        else if (month.getMonth() != real.getMonth()) {\n          const cell = row.appendChild(document.createElement(\"th\"));\n          cell.colSpan = 2;\n          cell.classList.add(\"fc-day-empty\");\n        }\n\n        // real day\n        else {\n          let hasBg = false;\n          const dayStart = new Date(real.valueOf());\n          dayStart.setHours(0);\n          dayStart.setMinutes(0);\n          dayStart.setSeconds(0);\n          dayStart.setMilliseconds(0);\n          const dayEnd = new Date(dayStart.valueOf());\n          dayEnd.setDate(dayEnd.getDate() + 1);\n          const classes = [\"fc-day\"];\n          if ([0, 6].includes(real.getDay())) classes.push(\"fc-day-weekend\");\n          if (\n            real.toISOString().substr(0, 10) ==\n            today.toISOString().substr(0, 10)\n          )\n            classes.push(\"fc-day-today\");\n\n          // html\n          const day = row.appendChild(document.createElement(\"td\"));\n          day.classList.add(...classes);\n          day.appendChild(\n            document.createTextNode((\"0\" + real.getDate()).slice(-2))\n          );\n          day.appendChild(document.createElement(\"br\"));\n          day.appendChild(\n            document.createTextNode(\n              real.toLocaleString(\"de\", { weekday: \"short\" })\n            )\n          );\n          const cell = row.appendChild(document.createElement(\"td\"));\n          cell.classList.add(\"fc-events\");\n          events\n            .filter(\n              (event) =>\n                event.instance.range.start.getTime() >= dayStart.getTime() &&\n                event.instance.range.start.getTime() < dayEnd.getTime()\n            )\n            .map((event) => {\n              // background event\n              if (\n                [event.def.ui.display, event.src.display].includes(\"background\")\n              ) {\n                if (hasBg) return;\n                hasBg = true;\n                let bg = day.appendChild(document.createElement(\"div\"));\n                bg.classList.add(\"fc-bg-event\");\n                bg.style.backgroundColor =\n                  event.def.ui.backgroundColor || event.src.backgroundColor;\n                bg.style.borderColor =\n                  event.def.ui.borderColor || event.src.borderColor;\n                bg.style.textColor =\n                  event.def.ui.textColor || event.src.textColor;\n                bg = cell.appendChild(bg.cloneNode(true));\n                bg.appendChild(document.createTextNode(event.def.title));\n              }\n\n              // normal event\n              else {\n                const evt = cell.appendChild(document.createElement(\"div\"));\n                evt.classList.add(\n                  \"fc-daygrid-event\",\n                  \"fc-h-event\",\n                  \"fc-event\",\n                  ...event.def.ui.classNames,\n                  ...event.src.classNames\n                );\n                evt.style.backgroundColor =\n                  event.def.ui.backgroundColor || event.src.backgroundColor;\n                evt.style.borderColor =\n                  event.def.ui.borderColor || event.src.borderColor;\n                evt.style.textColor =\n                  event.def.ui.textColor || event.src.textColor;\n                const div = evt.appendChild(document.createElement(\"div\"));\n                div.classList.add(\"fc-event-main\");\n                div.appendChild(document.createElement(\"a\"));\n                div.appendChild(document.createTextNode(event.def.title));\n                const meta = div.appendChild(document.createElement(\"div\"));\n                meta.classList.add(\"fc-event-meta\");\n\n                // event time\n                if (!event.def.allDay) {\n                  const time = meta.appendChild(document.createElement(\"div\"));\n                  time.classList.add(\"fc-event-time\");\n                  time.appendChild(\n                    document.createTextNode(\n                      event.instance.range.start.toLocaleTimeString(\n                        options.locale || navigator.language,\n                        options.eventTimeFormat?.standardDateProps || {}\n                      )\n                    )\n                  );\n                }\n\n                // event location\n                if (event.def.extendedProps.location) {\n                  const location = meta.appendChild(\n                    document.createElement(\"div\")\n                  );\n                  location.classList.add(\"fc-event-location\");\n                  location.appendChild(\n                    document.createTextNode(event.def.extendedProps.location)\n                  );\n                }\n              }\n            });\n        }\n        month.setMonth(month.getMonth() + 1);\n      }\n    }\n    return { domNodes: [table] };\n  },\n};\n"],"names":["dateAlignment","duration","years","content","args","today","Date","options","calendar","getCurrentData","end","dateProfile","renderRange","evtInstances","Object","values","eventStore","instances","table","document","createElement","classList","add","events","i","length","src","eventUiBases","defId","push","instance","def","defs","date","row","appendChild","month","start","valueOf","setDate","getTime","offset","getDay","real","style","width","minWidth","cell","colSpan","link","createTextNode","toLocaleString","getMonth","hasBg","dayStart","setHours","setMinutes","setSeconds","setMilliseconds","dayEnd","getDate","classes","includes","toISOString","substr","day","slice","weekday","filter","event","range","map","ui","display","bg","backgroundColor","borderColor","textColor","cloneNode","title","evt","classNames","div","meta","allDay","time","toLocaleTimeString","locale","navigator","language","eventTimeFormat","standardDateProps","extendedProps","location","setMonth","domNodes"],"mappings":"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"}