this.FullCalendar=this.FullCalendar||{},this.FullCalendar.CalDavSource=function(){"use strict";function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,r){if(!t)return;if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,r)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return("000000000"+t).slice(-e)},n=function(t){return t.getUTCFullYear()+r(t.getUTCMonth()+1)+r(t.getUTCDate())+"T"+r(t.getUTCHours())+r(t.getUTCMinutes())+r(t.getUTCSeconds())+"Z"},a=function(t,e,r){var n=function(t,e,r){var n={classNames:[].concat((t.description&&t.description.match(/#[a-zA-Z0-9]+/g)||[]).map((function(t){return"category-".concat(t.substr(1))}))).concat(t._firstProp("status")&&["status-".concat(t._firstProp("status").toLowerCase())]||[]),description:t.description,end:r?r.toString():t.endDate.toString(),location:t.location,start:e?e.toString():t.startDate.toString(),title:t.summary};return t.description&&t.description.match(new RegExp("https?://[^ ]+"))&&(n.url=t.description.match(new RegExp("https?://[^ ]+"))[0]),n},a=ICAL.parse(t);return new ICAL.Component(a).getAllSubcomponents("vevent").flatMap((function(t){var a=new ICAL.Event(t);if(a.isRecurring()){for(var o,i=[],s=(new ICAL.Time).fromJSDate(e),c=(new ICAL.Time).fromJSDate(r),u=a.iterator();(o=u.next())&&o.compare(c)<=0;)if(o.compare(s)>=0){var l=a.getOccurrenceDetails(o);i.push(n(l.item,l.startDate,l.endDate))}return i}return a.isRecurrenceException()?[]:[n(a)]}))};return function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.assign(r,{events:function(r,o,i){var s=new XMLHttpRequest;s.open("REPORT",e),s.onload=function(){if(s.status>=200&&s.status<400){for(var e=(new DOMParser).parseFromString(s.response,"text/xml").getElementsByTagName("cal:calendar-data"),n=[],c=0;c<e.length;c++)n.push.apply(n,t(a(e[c].innerHTML,r.start,r.end)));o(n)}else i("failed to fetch",s)},s.onerror=function(){return i("failed to fetch",s)},s.setRequestHeader("Depth","1"),s.send('<?xml version="1.0" encoding="utf-8" ?><x1:calendar-query xmlns:x1="urn:ietf:params:xml:ns:caldav"><x0:prop xmlns:x0="DAV:"><x1:calendar-data/></x0:prop><x1:filter><x1:comp-filter name="VCALENDAR"><x1:comp-filter name="VEVENT"><x1:time-range start="'+n(r.start)+'" end="'+n(r.end)+'"/></x1:comp-filter></x1:comp-filter></x1:filter></x1:calendar-query>')}})}}();//# sourceMappingURL=caldav.js.map
