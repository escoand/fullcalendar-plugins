{"version":3,"file":"dblclicking.js","sources":["../src/interaction/dblclicking.ts"],"sourcesContent":["import { createPlugin, EventClickArg } from \"@fullcalendar/core\";\r\nimport {\r\n  elementClosest,\r\n  EventImpl,\r\n  getElSeg,\r\n  identity,\r\n  Identity,\r\n  Interaction,\r\n  InteractionSettings,\r\n} from \"@fullcalendar/core/internal\";\r\n\r\nfunction buildDelegationHandler<EventType extends Event | UIEvent>(\r\n  selector: string,\r\n  handler: (ev: EventType, matchedTarget: HTMLElement) => void\r\n) {\r\n  return (ev: EventType) => {\r\n    let matchedChild = elementClosest(ev.target as HTMLElement, selector);\r\n\r\n    if (matchedChild) {\r\n      handler.call(matchedChild, ev, matchedChild);\r\n    }\r\n  };\r\n}\r\n\r\nfunction listenBySelector(\r\n  container: HTMLElement,\r\n  eventType: string,\r\n  selector: string,\r\n  handler: (ev: Event, matchedTarget: HTMLElement) => void\r\n) {\r\n  let attachedHandler = buildDelegationHandler(selector, handler);\r\n\r\n  container.addEventListener(eventType, attachedHandler);\r\n\r\n  return () => {\r\n    container.removeEventListener(eventType, attachedHandler);\r\n  };\r\n}\r\n\r\nclass EventDblClickInteraction extends Interaction {\r\n  constructor(settings: InteractionSettings) {\r\n    super(settings);\r\n\r\n    this.destroy = listenBySelector(\r\n      settings.el,\r\n      \"dblclick\",\r\n      \".fc-event\", // on both fg and bg events\r\n      this.handleSegDblClick\r\n    );\r\n  }\r\n\r\n  handleSegDblClick = (ev: Event, segEl: HTMLElement) => {\r\n    let { component } = this;\r\n    let { context } = component;\r\n    let seg = getElSeg(segEl);\r\n\r\n    if (\r\n      seg && // might be the <div> surrounding the more link\r\n      component.isValidSegDownEl(ev.target as HTMLElement)\r\n    ) {\r\n      // our way to simulate a link click for elements that can't be <a> tags\r\n      // grab before trigger fired in case trigger trashes DOM thru rerendering\r\n      let hasUrlContainer = elementClosest(\r\n        ev.target as HTMLElement,\r\n        \".fc-event-forced-url\"\r\n      );\r\n      let url = hasUrlContainer\r\n        ? (hasUrlContainer.querySelector(\"a[href]\") as any).href\r\n        : \"\";\r\n\r\n      context.emitter.trigger(\"eventDblClick\", {\r\n        el: segEl,\r\n        event: new EventImpl(\r\n          component.context,\r\n          seg.eventRange?.def,\r\n          seg.eventRange?.instance\r\n        ),\r\n        jsEvent: ev as MouseEvent, // Is this always a mouse event? See #4655\r\n        view: context.viewApi,\r\n      } as EventClickArg);\r\n\r\n      if (url && !ev.defaultPrevented) {\r\n        window.location.href = url;\r\n      }\r\n    }\r\n  };\r\n}\r\n\r\nexport default createPlugin({\r\n  name: \"EventDblClickPlugin\",\r\n  componentInteractions: [EventDblClickInteraction],\r\n  listenerRefiners: {\r\n    eventDblClick: identity as Identity<(arg: EventClickArg) => void>,\r\n  },\r\n});\r\n"],"names":["EventDblClickPlugin","core","internal","listenBySelector","container","eventType","selector","handler","attachedHandler","ev","matchedChild","elementClosest","target","call","buildDelegationHandler","addEventListener","removeEventListener","EventDblClickInteraction","Interaction","constructor","settings","super","this","destroy","el","handleSegDblClick","segEl","component","context","seg","getElSeg","isValidSegDownEl","hasUrlContainer","url","querySelector","href","emitter","trigger","event","EventImpl","eventRange","def","instance","jsEvent","view","viewApi","defaultPrevented","window","location","createPlugin","name","componentInteractions","listenerRefiners","eventDblClick","identity","FullCalendar","Internal"],"mappings":"AAWA,IAAAA,oBAAA,SAAAC,EAAAC,GAAA,aAaA,SAASC,EACPC,EACAC,EACAC,EACAC,GAEA,IAAIC,EAnBN,SACEF,EACAC,GAEA,OAAQE,IACN,IAAIC,EAAeC,EAAAA,eAAeF,EAAGG,OAAuBN,GAExDI,GACFH,EAAQM,KAAKH,EAAcD,EAAIC,GAGrC,CAQwBI,CAAuBR,EAAUC,GAIvD,OAFAH,EAAUW,iBAAiBV,EAAWG,GAE/B,KACLJ,EAAUY,oBAAoBX,EAAWG,GAE7C,CAEA,MAAMS,UAAiCC,EAAAA,YACrCC,WAAAA,CAAYC,GACVC,MAAMD,GAENE,KAAKC,QAAUpB,EACbiB,EAASI,GACT,WACA,YACAF,KAAKG,kBAET,CAEAA,kBAAoBA,CAAChB,EAAWiB,KAC9B,IAAIC,UAAEA,GAAcL,MAChBM,QAAEA,GAAYD,EACdE,EAAMC,EAAAA,SAASJ,GAEnB,GACEG,GACAF,EAAUI,iBAAiBtB,EAAGG,QAC9B,CAGA,IAAIoB,EAAkBrB,EAAAA,eACpBF,EAAGG,OACH,wBAEEqB,EAAMD,EACLA,EAAgBE,cAAc,WAAmBC,KAClD,GAEJP,EAAQQ,QAAQC,QAAQ,gBAAiB,CACvCb,GAAIE,EACJY,MAAO,IAAIC,EAAAA,UACTZ,EAAUC,QACVC,EAAIW,YAAYC,IAChBZ,EAAIW,YAAYE,UAElBC,QAASlC,EACTmC,KAAMhB,EAAQiB,UAGZZ,IAAQxB,EAAGqC,mBACbC,OAAOC,SAASb,KAAOF,EAE3B,GAUF,OANagB,eAAa,CAC1BC,KAAM,sBACNC,sBAAuB,CAAClC,GACxBmC,iBAAkB,CAChBC,cAAeC,EAAAA,WAEjB,CAnFF,CAmFEC,aAAAA,aAAAC"}